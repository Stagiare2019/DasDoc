{% extends "base+nav.html.twig" %}
{# 
    Ce template affiche des actes en lien avec l'utilisateur (brouillons)
    et l'historique des 10 dernières actions de l'utilisateur.

    N.B. : Les actions ne sont pas supprimés si l'acte qu'elle réfère est supprimé
    (Ceci explique le {% if action.fkActe is not null %}).
#}
{% block body %}
	
	<h2 class="text-center pt-3 pb-3">Actes en cours</h2>

	<h3>Historique des actions</h3>

	{# Table des actions #}
	<table class="table table-bordered table-striped table-hover">
	    <thead>
		    <tr>
		    	<th scope="col">Type</th>
		    	<th scope="col">Date</th>
		    	<th scope="col">Numero</th>
		    	<th scope="col">Nature</th>
		    	<th scope="col">Matière</th>
		    	<th scope="col">Objet de l'acte</th>
	    	</tr>
	    </thead>
	    <tbody>
	    	{% for action in historique %}
	    		
		    <tr>
		    	<td>{{ action.fkType }}</a></td>
		    	<td>{{ action.date|date('d/m/Y') }}</a></td>

		    	{% if action.fkActe is not null %}
		    	{# Le lien va remplacer pdf_directory par l'emplacement des pdfs et le concaténer avec le nom du PDF
				Le petit script "onClick" affiche le pdf du lien dans une nouvelle fenêtre.
			    #}
			    <td><a href="file:///{{ pdf_directory ~ action.fkActe.nomPDF }}" onclick="window.open(this.href); return false;">
			    	{{ action.fkActe.numero }}</a></td>
			    <td>{{ action.fkActe.fkNature }}</a></td>
			    <td>{{ action.fkActe.fkMatiere }}</a></td>
			    <td>{{ action.fkActe.objet }}</td>
		    	{% endif %}

		    </tr>

	    	{% endfor %}
	    </tbody>
    </table>

	<h3>Brouillons</h3>

	{# Table des brouillons #}
	<table id="brouillons" class="table table-bordered table-striped table-hover">
	    <thead>
		    <tr>
		      	<th class="th-sm">Numéro</th>
				<th class="th-sm">Nature</th>
		      	<th class="th-sm">Matière</th>
		      	<th class="th-sm">Objet</th>
		      	<th class="th-sm">Actions</th>
		    </tr>
		</thead>
		<tbody>
		    {% for acte in brouillons %}

		    <tr>
		    	{# Le lien va remplacer pdf_directory par l'emplacement des pdfs et le concaténer avec le nom du PDF
				Le petit script "onClick" affiche le pdf du lien dans une nouvelle fenêtre.
			    #}
		    	<td><a href="file:///{{ pdf_directory ~ acte.nomPDF }}" onclick="window.open(this.href); return false;">
		    		{{ acte.numero }}</a></td>
		    	<td>{{ acte.fkNature }}</td>
		    	<td>{{ acte.fkMatiere }}</td>
				<td>{{ acte.objet }}</td>
				<td>

				    <a href={{ path('gestionnaire_suppression', {'id': acte.id}) }}>
				    	<img src="/img/acte/supprimer.png" alt="supprimer">
				    </a>

				     / 

				    <a href={{ path('gestionnaire_modification', {'id': acte.id}) }}>
				    	<img src="/img/acte/editer.png" alt="modifier">
				    </a>
				    
				</td>
		    </tr>

	    	{% endfor %}
		</tbody>
	</table>

{% endblock %}